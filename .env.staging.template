# SCR Platform — Staging Environment
# Mirror of production structure with staging-specific values.
# Staging uses real external services (Clerk, Sentry, S3) but separate accounts/buckets.
#
# Differences from production:
#   - APP_ENV=staging
#   - All URLs on staging.scr-platform.com
#   - SENTRY_ENVIRONMENT=staging
#   - SECRET_KEY can be weaker (but still >= 32 chars for parity)
#   - AI providers can use lower-tier/cheaper models
#   - demo_data and waitlist feature flags enabled by default
#
# NEVER commit a populated .env file. This template uses <PLACEHOLDER> values.

APP_ENV=staging
APP_DEBUG=false
APP_VERSION=1.0.0

# ── Database ──────────────────────────────────────────────────────────────────
DATABASE_URL=postgresql+asyncpg://<USER>:<PASS>@<RDS_STAGING_ENDPOINT>:5432/scr_platform_staging
DATABASE_URL_SYNC=postgresql://<USER>:<PASS>@<RDS_STAGING_ENDPOINT>:5432/scr_platform_staging
# No read replica needed in staging
# DATABASE_URL_READ_REPLICA=

# ── Redis ─────────────────────────────────────────────────────────────────────
REDIS_URL=redis://:<PASS>@<REDIS_STAGING_ENDPOINT>:6379/0
CELERY_BROKER_URL=redis://:<PASS>@<REDIS_STAGING_ENDPOINT>:6379/1

# ── Search ────────────────────────────────────────────────────────────────────
ELASTICSEARCH_URL=https://<ES_STAGING_ENDPOINT>:443

# ── Auth (Clerk — staging instance) ──────────────────────────────────────────
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_<REPLACE_ME>
CLERK_SECRET_KEY=sk_test_<REPLACE_ME>
CLERK_WEBHOOK_SECRET=whsec_<REPLACE_ME>
CLERK_ISSUER_URL=https://<YOUR_CLERK_STAGING_DOMAIN>.clerk.accounts.dev
CLERK_JWKS_CACHE_TTL=300

# ── AI Services ───────────────────────────────────────────────────────────────
# Staging can share API keys with production or use dedicated staging keys.
# Using lower-tier models here keeps staging costs manageable.
ANTHROPIC_API_KEY=sk-ant-<REPLACE_ME>
OPENAI_API_KEY=sk-<REPLACE_ME>
GOOGLE_API_KEY=<REPLACE_ME>
XAI_API_KEY=<REPLACE_ME>
DEEPSEEK_API_KEY=<REPLACE_ME>

# AI Gateway (internal staging ECS service)
AI_GATEWAY_URL=http://scr-ai-gateway-staging:8001
AI_GATEWAY_API_KEY=<GENERATE_WITH: python -c "import secrets; print(secrets.token_hex(32))">
AI_GATEWAY_API_KEY_PREVIOUS=
# Staging can use claude-sonnet instead of claude-opus to reduce costs
AI_DEFAULT_MODEL=claude-sonnet-4-20250514
AI_FALLBACK_MODEL=gpt-4o-mini
AI_EMBEDDING_MODEL=text-embedding-3-small

# ── Storage (AWS S3 — separate staging bucket) ────────────────────────────────
AWS_ACCESS_KEY_ID=<REPLACE_ME>
AWS_SECRET_ACCESS_KEY=<REPLACE_ME>
AWS_S3_BUCKET=scr-staging-documents
AWS_S3_REGION=eu-west-1
# AWS_S3_ENDPOINT_URL must NOT be set (uses real AWS S3 in staging)

# ── Vector DB (Pinecone — staging index) ──────────────────────────────────────
PINECONE_API_KEY=<REPLACE_ME>
PINECONE_ENVIRONMENT=eu-west1-gcp
PINECONE_INDEX_NAME=scr-documents-staging

# ── CRM Integrations ──────────────────────────────────────────────────────────
HUBSPOT_CLIENT_ID=<REPLACE_ME>
HUBSPOT_CLIENT_SECRET=<REPLACE_ME>
SALESFORCE_CONSUMER_KEY=<REPLACE_ME>
SALESFORCE_CONSUMER_SECRET=<REPLACE_ME>
SALESFORCE_REDIRECT_URI=https://api.staging.scr-platform.com/v1/connectors/salesforce/callback
SALESFORCE_CLIENT_ID=<REPLACE_ME>
SALESFORCE_CLIENT_SECRET=<REPLACE_ME>

# ── Email (Resend — staging domain) ──────────────────────────────────────────
RESEND_API_KEY=re_<REPLACE_ME>
EMAIL_FROM=noreply@staging.scr-platform.com

# ── Market Data APIs ──────────────────────────────────────────────────────────
FRED_API_KEY=<REPLACE_ME>
ALPHA_VANTAGE_API_KEY=<REPLACE_ME>

# ── Application ───────────────────────────────────────────────────────────────
API_URL=https://api.staging.scr-platform.com
FRONTEND_URL=https://app.staging.scr-platform.com
# Note: staging SECRET_KEY still needs to be >= 32 chars (same validation runs)
SECRET_KEY=<GENERATE_WITH: python -c "import secrets; print(secrets.token_hex(32))">

# ── Security / Rate Limiting ──────────────────────────────────────────────────
RATE_LIMIT_ENABLED=true
MAX_REQUEST_BODY_BYTES=52428800

# ── AI Token Budget ───────────────────────────────────────────────────────────
AI_TOKEN_BUDGET_ENABLED=true
AI_TOKEN_BUDGET_FOUNDATION=2000000
AI_TOKEN_BUDGET_PROFESSIONAL=20000000
AI_TOKEN_BUDGET_ENTERPRISE=200000000

# ── Monitoring (Sentry — staging project) ─────────────────────────────────────
SENTRY_DSN=https://<REPLACE_ME>@o0.ingest.sentry.io/<STAGING_PROJECT_ID>
NEXT_PUBLIC_SENTRY_DSN=https://<REPLACE_ME>@o0.ingest.sentry.io/<STAGING_PROJECT_ID>
SENTRY_AUTH_TOKEN=<REPLACE_ME>
SENTRY_ORG=<REPLACE_ME>
SENTRY_PROJECT=scr-platform-staging
SENTRY_ENVIRONMENT=staging

# ── Celery Monitoring (Flower) ─────────────────────────────────────────────────
FLOWER_USER=admin
FLOWER_PASSWORD=<REPLACE_ME>

# ── Frontend (Next.js public variables) ───────────────────────────────────────
NEXT_PUBLIC_API_URL=https://api.staging.scr-platform.com
NEXT_PUBLIC_APP_URL=https://app.staging.scr-platform.com
NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up
NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/
NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/

# ── Custom Domain ─────────────────────────────────────────────────────────────
CUSTOM_DOMAIN_CNAME_TARGET=custom.scr.io
