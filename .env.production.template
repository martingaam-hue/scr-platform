# SCR Platform — Production Environment
# All secrets must come from AWS Secrets Manager in production
# This file documents the required variables only
# See: infrastructure/terraform/secrets.tf for the Secrets Manager secret names
#
# NEVER commit a populated .env file. This template uses <PLACEHOLDER> values.
# To generate secrets:
#   python -c "import secrets; print(secrets.token_hex(32))"

APP_ENV=production
APP_DEBUG=false
APP_VERSION=1.0.0

# ── Database ──────────────────────────────────────────────────────────────────
DATABASE_URL=postgresql+asyncpg://<USER>:<PASS>@<RDS_ENDPOINT>:5432/scr_platform
DATABASE_URL_SYNC=postgresql://<USER>:<PASS>@<RDS_ENDPOINT>:5432/scr_platform
DATABASE_URL_READ_REPLICA=postgresql+asyncpg://<USER>:<PASS>@<RDS_READ_REPLICA_ENDPOINT>:5432/scr_platform

# ── Redis ─────────────────────────────────────────────────────────────────────
REDIS_URL=redis://:<PASS>@<REDIS_ENDPOINT>:6379/0
CELERY_BROKER_URL=redis://:<PASS>@<REDIS_ENDPOINT>:6379/1

# ── Search ────────────────────────────────────────────────────────────────────
ELASTICSEARCH_URL=https://<ES_ENDPOINT>:443

# ── Auth (Clerk) ──────────────────────────────────────────────────────────────
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_live_<REPLACE_ME>
CLERK_SECRET_KEY=sk_live_<REPLACE_ME>
CLERK_WEBHOOK_SECRET=whsec_<REPLACE_ME>
CLERK_ISSUER_URL=https://<YOUR_CLERK_DOMAIN>.clerk.accounts.dev
# Cache JWKS public keys for 5 minutes (balances security vs. performance)
CLERK_JWKS_CACHE_TTL=300

# ── AI Services ───────────────────────────────────────────────────────────────
ANTHROPIC_API_KEY=sk-ant-<REPLACE_ME>
OPENAI_API_KEY=sk-<REPLACE_ME>
GOOGLE_API_KEY=<REPLACE_ME>
XAI_API_KEY=<REPLACE_ME>
DEEPSEEK_API_KEY=<REPLACE_ME>

# AI Gateway (internal ECS service — not exposed externally)
AI_GATEWAY_URL=http://scr-ai-gateway:8001
AI_GATEWAY_API_KEY=<GENERATE_WITH: python -c "import secrets; print(secrets.token_hex(32))">
# Set AI_GATEWAY_API_KEY_PREVIOUS during key rotation; leave empty otherwise
AI_GATEWAY_API_KEY_PREVIOUS=
AI_DEFAULT_MODEL=claude-opus-4-20250514
AI_FALLBACK_MODEL=gpt-4o
AI_EMBEDDING_MODEL=text-embedding-3-large

# ── Storage (AWS S3) ──────────────────────────────────────────────────────────
AWS_ACCESS_KEY_ID=<REPLACE_ME>
AWS_SECRET_ACCESS_KEY=<REPLACE_ME>
AWS_S3_BUCKET=scr-production-documents
AWS_S3_REGION=eu-west-1
# Note: AWS_S3_ENDPOINT_URL must NOT be set in production (uses real AWS S3)
# AWS_S3_ENDPOINT_URL=  # Leave unset

# ── Vector DB (Pinecone) ──────────────────────────────────────────────────────
PINECONE_API_KEY=<REPLACE_ME>
PINECONE_ENVIRONMENT=eu-west1-gcp
PINECONE_INDEX_NAME=scr-documents-production

# ── CRM Integrations ──────────────────────────────────────────────────────────
HUBSPOT_CLIENT_ID=<REPLACE_ME>
HUBSPOT_CLIENT_SECRET=<REPLACE_ME>
SALESFORCE_CONSUMER_KEY=<REPLACE_ME>
SALESFORCE_CONSUMER_SECRET=<REPLACE_ME>
SALESFORCE_REDIRECT_URI=https://api.scr-platform.com/v1/connectors/salesforce/callback
# Legacy field aliases (kept for connector module compatibility)
SALESFORCE_CLIENT_ID=<REPLACE_ME>
SALESFORCE_CLIENT_SECRET=<REPLACE_ME>

# ── Email (Resend) ────────────────────────────────────────────────────────────
RESEND_API_KEY=re_<REPLACE_ME>
EMAIL_FROM=noreply@scr-platform.com

# ── Market Data APIs ──────────────────────────────────────────────────────────
FRED_API_KEY=<REPLACE_ME>
ALPHA_VANTAGE_API_KEY=<REPLACE_ME>

# ── Application ───────────────────────────────────────────────────────────────
API_URL=https://api.scr-platform.com
FRONTEND_URL=https://app.scr-platform.com
# SECRET_KEY must be >= 32 chars; anything shorter causes startup failure in production
SECRET_KEY=<GENERATE_WITH: python -c "import secrets; print(secrets.token_hex(32))">

# ── Security / Rate Limiting ──────────────────────────────────────────────────
RATE_LIMIT_ENABLED=true
MAX_REQUEST_BODY_BYTES=52428800

# ── AI Token Budget ───────────────────────────────────────────────────────────
AI_TOKEN_BUDGET_ENABLED=true
AI_TOKEN_BUDGET_FOUNDATION=2000000
AI_TOKEN_BUDGET_PROFESSIONAL=20000000
AI_TOKEN_BUDGET_ENTERPRISE=200000000

# ── Monitoring (Sentry) ───────────────────────────────────────────────────────
SENTRY_DSN=https://<REPLACE_ME>@o0.ingest.sentry.io/<PROJECT_ID>
NEXT_PUBLIC_SENTRY_DSN=https://<REPLACE_ME>@o0.ingest.sentry.io/<PROJECT_ID>
SENTRY_AUTH_TOKEN=<REPLACE_ME>
SENTRY_ORG=<REPLACE_ME>
SENTRY_PROJECT=scr-platform
SENTRY_ENVIRONMENT=production

# ── Celery Monitoring (Flower — internal only, not exposed via ALB) ────────────
FLOWER_USER=admin
FLOWER_PASSWORD=<GENERATE_STRONG_PASSWORD>

# ── Frontend (Next.js public variables) ───────────────────────────────────────
# NEXT_PUBLIC_* vars are baked into the frontend build — do NOT put secrets here
NEXT_PUBLIC_API_URL=https://api.scr-platform.com
NEXT_PUBLIC_APP_URL=https://app.scr-platform.com
NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up
NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/
NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/

# ── Custom Domain ─────────────────────────────────────────────────────────────
CUSTOM_DOMAIN_CNAME_TARGET=custom.scr.io
